<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>SQLModel - Data Science</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">Data Science</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">FastAPI</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../intro/" class="dropdown-item">Einführung</a>
</li>
                                    
<li>
    <a href="../first_steps/" class="dropdown-item">Erste Schritte</a>
</li>
                                    
<li>
    <a href="../data_models/" class="dropdown-item">Datenmodelle</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">SQLModel</a>
</li>
                                    
<li>
    <a href="../task/" class="dropdown-item">Aufgabe</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../data_models/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../task/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#arbeiten-mit-sqlmodel-in-fastapi" class="nav-link">Arbeiten mit SQLModel in FastAPI</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#was-ist-sqlmodel" class="nav-link">Was ist SQLModel?</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#datenbankverbindungen-und-sessions" class="nav-link">Datenbankverbindungen und Sessions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#crud-operationen-mit-sqlmodel" class="nav-link">CRUD-Operationen mit SQLModel</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#integration-von-sqlmodel-mit-fastapi" class="nav-link">Integration von SQLModel mit FastAPI</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="arbeiten-mit-sqlmodel-in-fastapi">Arbeiten mit SQLModel in FastAPI</h1>
<p><strong>SQLModel</strong> ist eine Bibliothek, die SQLAlchemy und Pydantic kombiniert. Sie ermöglicht es dir, Datenbankmodelle in FastAPI zu integrieren, ohne auf umfangreiche ORM-Definitionen verzichten zu müssen. SQLModel baut auf SQLAlchemy auf und verwendet Pydantic zur Validierung der Daten, sodass du Datenbankmodelle erstellen und gleichzeitig die Vorteile der Datenvalidierung von Pydantic nutzen kannst.</p>
<h2 id="was-ist-sqlmodel">Was ist SQLModel?</h2>
<p>SQLModel ist eine Bibliothek, die es ermöglicht, SQL-Datenbanken in FastAPI-Anwendungen zu integrieren. Sie stellt eine einfache Schnittstelle zur Verfügung, die es dir ermöglicht, sowohl Datenbankmodelle zu definieren als auch mit der Datenbank zu interagieren – alles in einer sauberen und einheitlichen API.</p>
<p>SQLModel ermöglicht die Definition von <strong>Pydantic-Modellen</strong>, die gleichzeitig auch <strong>Datenbankmodelle</strong> sind. Das bedeutet, dass du nur ein Modell schreiben musst, um sowohl mit der Datenbank als auch mit FastAPI zu arbeiten.</p>
<h3 id="installation">Installation</h3>
<pre><code class="language-bash">pip install sqlmodel
</code></pre>
<h3 id="erstellen-eines-einfachen-sqlmodel-datenmodells">Erstellen eines einfachen SQLModel-Datenmodells</h3>
<p>Ein SQLModel-Datenmodell ist sehr ähnlich wie ein Pydantic-Modell, aber mit zusätzlichen SQLAlchemy-Features wie <code>Field</code> und <code>Relationship</code> für die Datenbankinteraktion. </p>
<pre><code class="language-python">from sqlmodel import Field, SQLModel

class User(SQLModel, table=True):
    id: int = Field(default=None, primary_key=True)
    name: str
    email: str
    age: int
</code></pre>
<p>In diesem Beispiel haben wir ein einfaches <strong>User-Modell</strong> erstellt, das die Felder <code>id</code>, <code>name</code>, <code>email</code> und <code>age</code> enthält. Das <code>table=True</code>-Attribut signalisiert, dass dieses Modell eine Tabelle in der Datenbank repräsentiert.</p>
<h3 id="aufgabe">Aufgabe</h3>
<p>Erstelle ein weiteres Datenmodell, das <code>Product</code>-Daten mit den Feldern <code>name</code>, <code>price</code> und <code>description</code> speichert. Vergiss nicht, die <code>id</code> als Primärschlüssel hinzuzufügen.</p>
<h2 id="datenbankverbindungen-und-sessions">Datenbankverbindungen und Sessions</h2>
<p>Eine der wichtigsten Aufgaben beim Arbeiten mit SQLModel ist die Verbindung zur Datenbank und die Verwaltung von Sessions, um Transaktionen durchzuführen. SQLModel baut auf SQLAlchemy auf, sodass wir die gleiche Methode verwenden, um die Verbindung zur Datenbank herzustellen.</p>
<h3 id="verbindung-zur-datenbank-herstellen">Verbindung zur Datenbank herstellen</h3>
<p>Du kannst SQLModel mit einer SQLite-Datenbank oder einer anderen unterstützten Datenbank wie PostgreSQL oder MySQL verwenden. Hier ist ein einfaches Beispiel für die Verbindung zu einer SQLite-Datenbank:</p>
<pre><code class="language-python">from sqlmodel import create_engine, Session

# Erstelle die Verbindung zur SQLite-Datenbank
engine = create_engine(&quot;sqlite:///database.db&quot;)

# Erstelle die Tabellen in der Datenbank (falls sie noch nicht existieren)
SQLModel.metadata.create_all(engine)
</code></pre>
<h3 id="arbeiten-mit-sessions">Arbeiten mit Sessions</h3>
<p>Um mit der Datenbank zu interagieren, musst du eine Session erstellen, die es dir ermöglicht, Datensätze zu lesen, zu schreiben und zu aktualisieren.</p>
<pre><code class="language-python">from sqlmodel import Session

# Öffne eine Session, um mit der Datenbank zu interagieren
with Session(engine) as session:
    # Beispiel: Hinzufügen eines neuen Benutzers
    user = User(name=&quot;John Doe&quot;, email=&quot;johndoe@example.com&quot;, age=30)
    session.add(user)
    session.commit()
</code></pre>
<h3 id="aufgabe_1">Aufgabe</h3>
<p>Erstelle eine neue <code>Product</code>-Instanz, füge sie zur Datenbank hinzu und bestätige die Transaktion mit <code>session.commit()</code>.</p>
<h2 id="crud-operationen-mit-sqlmodel">CRUD-Operationen mit SQLModel</h2>
<p>SQLModel macht es einfach, grundlegende <strong>CRUD</strong>-Operationen (Create, Read, Update, Delete) auf Datenbanken durchzuführen. Nachdem du die Datenbankverbindung und das Modell eingerichtet hast, kannst du Datensätze einfach erstellen und abfragen.</p>
<h3 id="erstellen-eines-datensatzes-create">Erstellen eines Datensatzes (Create)</h3>
<pre><code class="language-python">with Session(engine) as session:
    new_user = User(name=&quot;Jane Doe&quot;, email=&quot;janedoe@example.com&quot;, age=25)
    session.add(new_user)
    session.commit()
</code></pre>
<h3 id="lesen-von-datensatzen-read">Lesen von Datensätzen (Read)</h3>
<pre><code class="language-python">with Session(engine) as session:
    user = session.query(User).filter(User.name == &quot;Jane Doe&quot;).first()
    print(user)
</code></pre>
<h3 id="aktualisieren-von-datensatzen-update">Aktualisieren von Datensätzen (Update)</h3>
<pre><code class="language-python">with Session(engine) as session:
    user = session.query(User).filter(User.name == &quot;Jane Doe&quot;).first()
    if user:
        user.age = 26
        session.commit()
</code></pre>
<h3 id="loschen-von-datensatzen-delete">Löschen von Datensätzen (Delete)</h3>
<pre><code class="language-python">with Session(engine) as session:
    user = session.query(User).filter(User.name == &quot;Jane Doe&quot;).first()
    if user:
        session.delete(user)
        session.commit()
</code></pre>
<h3 id="aufgabe_2">Aufgabe</h3>
<p>Erweitere das <code>User</code>-Modell um ein <code>address</code>-Feld und führe eine <code>UPDATE</code>-Operation durch, um die Adresse eines bestimmten Benutzers zu ändern.</p>
<h2 id="integration-von-sqlmodel-mit-fastapi">Integration von SQLModel mit FastAPI</h2>
<p>Ein großer Vorteil von SQLModel ist, dass es nahtlos mit FastAPI integriert werden kann. Du kannst SQLModel-Modelle direkt in deine FastAPI-Routen einbinden, um API-Endpunkte zu erstellen, die mit der Datenbank interagieren.</p>
<h3 id="beispiel-fur-einen-fastapi-endpunkt-mit-sqlmodel">Beispiel für einen FastAPI-Endpunkt mit SQLModel</h3>
<pre><code class="language-python">from fastapi import FastAPI
from sqlmodel import Session, select

app = FastAPI()

@app.post(&quot;/users/&quot;)
async def create_user(user: User):
    with Session(engine) as session:
        session.add(user)
        session.commit()
    return {&quot;user&quot;: user}
</code></pre>
<p>In diesem Beispiel haben wir eine <code>POST</code>-Route erstellt, die ein <code>User</code>-Objekt entgegennimmt und es in die Datenbank speichert.</p>
<h3 id="aufgabe_3">Aufgabe</h3>
<p>Erstelle eine <code>GET</code>-Route, die alle Benutzer aus der Datenbank abruft und zurückgibt.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
